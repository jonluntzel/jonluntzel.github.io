---
layout: post
title:  "mafs"
date:   2024-03-14 
categories: jekyll update
---

The spectrum of a matrix tells you a whole lot. Eigenvalues and matrix entries are directly related by the determinant - but trying to grasp spectral information by eyeing individual entries is often not sane. 
<p align=center>
$$\det (\lambda I - A) = 0$$
</p>
<p align =center>
$\lambda$, the eigenvalues of $A$. Roots of $\det(A)$
</p>

Eigensystems curiously interlace individual entries and respond in surprising ways from small perturbations. For that reason, a [video](https://www.youtube.com/watch?v=OoG1-6eBNt4) by Senya Shlosman on matrices whose eigenvalues are integer-linear combinations of their entries caught my interest. I had (and have) a lot of questions about the area. So this here troglodyte brain got his stick out and poked around a bit.
<a name="heading">
</a>
<p align=center>
$$det(A) = \sum_{i=1}^{n}(-1)^{i+j}a_{i,j}M_{i,j}$$
</p>
<p align=center>
$$det(A) = \sum_{\sigma \in S_{n}}^{}\big(sgn(\sigma)\prod_{i=1}^{n}a_{i,\sigma(i)}\big)$$
</p>
<p align=center>
<sub>The cofactor expansion and its unrolled counterpart below relating the determinant to individual matrix entries. The intuition for how single entries in relation to others contribute to the full spectrum is often confusing.<sub>
</p?>

Researchers find subsets of matrices from the following construction:
* Select a finite strict partial order (Fig. 1)
* Determine size-n permutations phi which satisfy said order
* Create a matrix whose (i,j) entries are $\phi_{i}\phi_{j}(id)$
* For each entry, convert into a binary string marking increases or decreases in the sequence. For example, $132 \rightarrow 10$.

<p align=center>
<p align="center">
  <img src="/imgs/65.png" width="300"/>
</p>
<p align=center>
<sub>Fig. 1: the partial order defined by the relations $(1<2, 2<3, 2<4)$ on an $n=4$ size system (transitive completion dashed). A partial order  applies inequality constraints to a list of elements. In this case, two permutations satisfy the order. <sub>
</p?>

You probably won't see a miracle by choosing a random order, and computing eigenvalues gets hard quick. So as a first stab we could filter for partial orders whose permutation's squares are all equal to one another to make the matrix diagonal have equal entries and increase the odds of seeing nice examples. We can find a more general way later.

<p align="center">
<img src="/imgs/66.png" width="800"/> 
</p>
<p align=center>
  <sub>A 9*9 matrix with integer-linear eigenvalues.<sub>
</p>

For these orders what kind of permutations are squares of themselves? Well, applying a permutation twice resets the elements, so it must only contain local transpositions (swaps). Let's look at these orders graphically.

<p align=center>
<p align="center">
  <img src="/imgs/64.png" width="300"/>
</p>
<p align=center>
<sub>Fig 2: Order as a graph. Free regions link their individual entries to the fixed chain but not within itself.<sub>
</p>
  
Stacking the paths (Fig. 2) we can see shared vertices are fixed nodes and variable entries at an index are 2-cycles. Fixed nodes form a chain amongst themselves and free nodes wire to the start of fixed chains to restrict their freedom amongst themselves. Chains can neighbor free regions like in $1(23)4$ and we see the same chains at $1$ and $4$ in paths $1\text{ }x\text{ }y\text{ }4$ and gaps that enumerate $2$-length selections $xy$ from the table below. The analogy extends to multiple free regions or blocks like $1(23)(45)$.
  
```math
\lbrace 2,3 \rbrace \times \lbrace 2,3 \rbrace = \begin{pmatrix}22 && 23 \\ 32 && 33\end{pmatrix}.
```

Expanding from matrices with constant diagonals to ones whose permutations allow non-disjoint local swaps, a block (block-motif) allows non-disjoint swaps on a subset of elements such as $(12)$ in the order $(12)3$, implying 1 and 2 can freely swap. Or $1(234)5$ ensuring $2<4$ but the suborder indexed by $(234)$ has no other entries/edges. Visually a b-block has b-1 overlapping 2-blocks - $(1(2)3)$. Elementary block lengths of this slight expansion that we can build orders from are the primes intersected with $fib()$. A block makes $fib(b)$ permutations, and the product of disjoint block dimensions yields an order's resulting matrix size. Using || for cardinality, $fib(|(1(2)3)|)=fib(2)=2$, e.g. $(12) \rightarrow 
 | \lbrace 12, 21 \rbrace | = 2$.

<p align=center>
$$\begin{matrix}112358... n \\ \text{ }012345... |b|\end{matrix}$$
</p>

Elementary block dimensions are the primes intersected with fib. If orders share the same prime block factorization (factor using values in  $\mathbb{P} \cap fib()$ ), they both yield n valid permutations. So the number of block orders yielding n permutations is equal to the number of unique prime block factorizations of n.

Given k blocks of dimensions $b_i$, let e and p be the unique dimensions of k blocks and their respective frequencies. The number of arrangements of the given blocks over n fixed elements (the # of such partial orders) is 

```math
x=\frac{\prod\limits^{k}_{i=1}(n-(\sum\limits^{k}_{j=1}b_j-i))}{\prod\limits^{|p|}_{j=1}p_{j}!}
```

You can think of it as a modified combinatorial problem with putting balls into bins. The denominator accounts for symmetries in block assignments ($212$ permutes on same-valued indexes are identical). For example when $k=2$ blocks of size  $b=\lbrace 3,2 \rbrace$, we have  $x=(n-4)(n-3)$, or  $b=\lbrace 2,2 \rbrace$ yields $x=\frac{(n-3)(n-2)}{2}$. If I have $k=3$ blocks $\lbrace 6,2,2 \rbrace$ then $x=\frac{(n-9)(n-8)(n-7)}{2}$, and so on. 

The initial construction does not actually span the space of stochastic matrices with integer-linear eigenvalues. Even then, are the stochastic integer-linear eigenvalue matrices still just a subset?

<p align="center">
<img src="/imgs/63.png" width="600"/>
</p>
<p align=center>
<sub>Fig. 3: The set of all compatible full-rank 3*3 row-stochastic matrices up to isomorphism and variable relabeling (there are 10 of any rank)<sub>
</p>

<p align="center">
<img src="/imgs/62.png" width="600"/>
</p>
<p align=center>
<sub>Fig. 3b: Same set, but 4*4 matrices & sorted by their eigenvalues.<sub>
</p>

We can rewrite the resultant matrix $A$ as a $2*2$ block matrix 
```math 
\begin{pmatrix} X & P \\ Q & Y\end{pmatrix}
```
and exploit [Schur's complement](https://math.stackexchange.com/questions/1905652/proofs-of-determinants-of-block-matrices) for invertible X to compute $\det(A) = \det(X)*\det(Y - Q . X^{-1} . P)$. Similar to the [cofactor expansion](#heading) we can recursively apply this definition to make headway on the 'why' ile matrices happen.

<p align="center">
<img src="/imgs/67.png" width="800"/>
</p>

<sub>Fig. 4: Example decomposition and determinant calculation. Even for big $n$ you can choose a sub-block $X$ that is an ile matrix whose factors cancel from the inner contributing $X^-1$ term and outer $\det(X)$, while the remaining components form integer-linear factors and can conserve factors of $\det(X)$.<sub>

Working from a given block order you can partition it anywhere that does not interrupt a given block to get submatrices that are valid ile matrices (Fig. 4). For example, $1(23)|4$ defines $n=3$ and $n=1$ ole submatrices, while $1(2|3)4$ does not. It's structurally nice to partition out large ile submatrices, which may require shuffling index labels around ($B =P^{-1}AP$ applies the same permutation to rows and columns, so it just shuffles the order of nodes in the partial order around).

To avoid the semantic overlap on 'blocks' as subsets of elements allowing local transpositions and 'blocks' as submatrices of a partitioned matrix, I'll call the former definition block-motifs. There are loose ends here, but I thought it would be nice to leave the circle open for pi day. For partitions that do not interrupt block-motifs, the sub-block diagonals are ile for any ile matrix, and so working out the induction for the proof from a recursively defined XPQY-block-partition should be a satisfiable route to seeing how and why these miracles happen. 
